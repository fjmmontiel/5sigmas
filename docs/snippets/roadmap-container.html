<!-- Unified Roadmap with Series Cards -->
<div class="roadmap-unified">
  <!-- CSS Line Implementation -->
  <div class="roadmap-line">
    <div class="roadmap-rail"></div>
    <div id="rm-progress" class="roadmap-progress"></div>
  </div>

  <!-- Step 1: Cimientos -->
  <div class="roadmap-step step-1">
    <div class="roadmap-marker">1</div>
    <!-- Card Structure -->
    <a href="series/cimientos-de-la-ia-moderna/00_presentacion_serie/" class="series-card available"
      title="Empezar por: Cimientos de la IA moderna">
      <div class="series-card-inner">
        <div class="series-card-front">
          <div class="icon-wrapper">
            <span class="series-icon">üß±</span>
          </div>
          <h3 class="series-title">Cimientos de la IA moderna</h3>
          <div class="status-pill available">Empieza aqu√≠</div>
        </div>
        <div class="series-card-back">
          <h3 class="series-title-back">Cimientos de la IA moderna</h3>
          <p class="series-long-desc">
            Una serie para construir criterio desde abajo: qu√© es (y qu√© no es) la IA, c√≥mo aprenden los modelos,
            qu√© cambia con la IA generativa, embeddings, transformers, RAG, evaluaci√≥n y l√≠mites.
          </p>
          <span class="cta-link">Ver presentaci√≥n &rarr;</span>
        </div>
      </div>
    </a>
  </div>

  <!-- Step 2: De las cavernas a la AGI -->
  <div class="roadmap-step step-2">
    <div class="roadmap-marker">2</div>
    <a href="series/from-cave-to-AGI/00_presentacion_serie/" class="series-card available"
      title="Leer serie: De las cavernas a la AGI">
      <div class="series-card-inner">
        <div class="series-card-front">
          <div class="icon-wrapper">
            <span class="series-icon">üß†</span>
          </div>
          <h3 class="series-title">De las cavernas a la AGI</h3>
          <div class="status-pill available">Disponible</div>
        </div>
        <div class="series-card-back">
          <h3 class="series-title-back">De las cavernas a la AGI</h3>
          <p class="series-long-desc">
            Un viaje hist√≥rico para entender por qu√© la IA progresa a saltos: qu√© funcion√≥, qu√© se rompi√≥ y
            c√≥mo llegamos a los modelos actuales.
          </p>
          <span class="cta-link">Leer serie &rarr;</span>
        </div>
      </div>
    </a>
  </div>

  <!-- Step 3: Modelos razonadores -->
  <div class="roadmap-step step-3">
    <div class="roadmap-marker">3</div>
    <div class="series-card locked">
      <div class="series-card-inner">
        <div class="series-card-front">
          <div class="icon-wrapper">
            <span class="series-icon">‚è±Ô∏è</span>
          </div>
          <h3 class="series-title">Modelos razonadores y tiempo f√≠sico</h3>
          <div class="status-pill upcoming">Pr√≥ximamente</div>
        </div>
        <div class="series-card-back">
          <h3 class="series-title-back">Modelos razonadores y tiempo f√≠sico</h3>
          <p class="series-long-desc">
            Qu√© significa ‚Äúrazonar‚Äù en modelos actuales, qu√© cuesta (latencia, compute, fiabilidad) y qu√© cambia
            cuando el sistema interact√∫a con un entorno con restricciones f√≠sicas.
          </p>
        </div>
      </div>
    </div>
  </div>

  <!-- Step 4: Energ√≠a y Felicidad -->
  <div class="roadmap-step step-4">
    <div class="roadmap-marker">4</div>
    <div class="series-card locked">
      <div class="series-card-inner">
        <div class="series-card-front">
          <div class="icon-wrapper">
            <span class="series-icon">‚ö°</span>
          </div>
          <h3 class="series-title">IA, PIB, felicidad y electricidad</h3>
          <div class="status-pill upcoming">Pr√≥ximamente</div>
        </div>
        <div class="series-card-back">
          <h3 class="series-title-back">IA, PIB, felicidad y electricidad</h3>
          <p class="series-long-desc">
            Un marco para pensar la IA como fen√≥meno econ√≥mico y energ√©tico: crecimiento, desigualdad, costes reales
            e infraestructura el√©ctrica.
          </p>
        </div>
      </div>
    </div>
  </div>

  <!-- Step 5: Datacenters Espaciales -->
  <div class="roadmap-step step-5">
    <div class="roadmap-marker">5</div>
    <div class="series-card locked">
      <div class="series-card-inner">
        <div class="series-card-front">
          <div class="icon-wrapper">
            <span class="series-icon">üõ∞Ô∏è</span>
          </div>
          <h3 class="series-title">Datacenters en el espacio</h3>
          <div class="status-pill upcoming">Pr√≥ximamente</div>
        </div>
        <div class="series-card-back">
          <h3 class="series-title-back">Datacenters en el espacio</h3>
          <p class="series-long-desc">
            F√≠sica, costes y trade-offs de llevar computaci√≥n fuera de la Tierra. Una disecci√≥n sin ciencia ficci√≥n.
          </p>
        </div>
      </div>
    </div>
  </div>
</div>

<script>
  (function () {
    const container = document.querySelector('.roadmap-unified');
    if (!container) return;

    // Enable animations
    container.classList.add('rm-anim-ready');

    const progressLine = document.getElementById('rm-progress');
    const steps = document.querySelectorAll('.roadmap-step');

    // 1. Scroll Progress Logic
    function updateLine() {
      if (!progressLine) return;
      const rect = container.getBoundingClientRect();
      const viewportHeight = window.innerHeight;

      // Logic: 0% when top of container hits 60% viewport
      // 100% when bottom of container hits 40% viewport

      const startY = viewportHeight * 0.6;
      const end = rect.height;

      // Relative position calculation
      let currentY = startY - rect.top;
      let percentage = currentY / rect.height;

      // Extend range slightly so it looks fully filled when passing sections
      percentage = (percentage + 0.1) * 1.1;
      percentage = Math.max(0, Math.min(1, percentage));

      progressLine.style.height = (percentage * 100) + '%';
    }

    const onScroll = () => requestAnimationFrame(updateLine);
    window.removeEventListener('scroll', onScroll);
    window.addEventListener('scroll', onScroll);
    updateLine();

    // 2. Element Appearance Logic
    const observer = new IntersectionObserver((entries) => {
      entries.forEach(entry => {
        if (entry.isIntersecting) {
          entry.target.classList.add('is-visible');
        }
      });
    }, { threshold: 0.25 });

    steps.forEach(s => observer.observe(s));
  })();
</script>